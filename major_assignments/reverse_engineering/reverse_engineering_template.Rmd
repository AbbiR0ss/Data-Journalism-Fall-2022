---
title: "Reverse Engineering Project"
author: Abbi Ross, Group 2
date: Oct. 16, 2022
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, [STORY NAME](STORY URL)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
options(scipen=999)
library(tidyverse)
library(lubridate)
library(janitor)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 

# Load required data # Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")
```{r}
moore_contribs <- read.csv("data/Moore_ContributionsList.csv")
```

# Clean required data and prepare for analysis if needed. 
``` {r}
moore_contribs <- moore_contribs %>%
  clean_names()
```

```{r}
moore_contribs
glimpse
```

```{r}
moore_contribs_cleaned <- moore_contribs %>% mutate(contribution_date=mdy(contribution_date))
head(moore_contribs_cleaned)
```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: “We set the pace in fundraising — including raising more money in Maryland and having 73% of donations $100 or less — because this campaign has inspired thousands of people from all walks of life in Maryland and across the country who see the opportunity to make Wes Moore governor of Maryland and change the trajectories of families who have been left behind,” the campaign said in a statement."
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

A.) We were not able to confirm the finding because of issues with our code. We tried a number of different codes and even kepy working on it after turning it in earlier today with Dylan's submission. Sununu's code from 115-127 is the closest now, and he said it worked for him -- but it hasn't worked for me. At this point I'm so confused and I wanted to leave all of my examples so you could see them, so it's definitely a lot.

Updated Answer 10/16: I updated my code with what we worked on last weekend after submitting. I feel closer to the correct answer now, but also just realized we're missing the actual percentage. I will work on adding that as well.

#We filtered the data for contributions under 100
```{r}
# Put code to reverse engineer sentence here
moore_contribs_under_hundred <- moore_contribs_cleaned %>%
  filter(contribution_amount < 100)
```

#After filtering, we set out to seperate the number of contribs under 100 and their amounts

```{r}
moore_contribs_under_hundred <- moore_contribs_under_hundred %>%
  group_by(contributor_name) %>%
  summarise(total = n(), amount = sum(contribution_amount)) %>%
  arrange(desc(total))
moore_contribs_under_hundred
# Display results of code below this codeblock
```

### Sentence 2

* **Sentence text**: "Tom Perez, a former leader of the Democratic National Committee, raised nearly $1.7 million in donations from outside Maryland.” 
* **Analysis summary**: Our code is saying that Perez raised over $2.4 million in out-of-state donations. We found there to be 3,601 contributions for a total of $2,451,371. This leads me to believe that we did not properly clean Maryland out of contributor state column or there's another issue we are overlooking. To better understand this issue, we will need to rerun our code and most likely to do some more cleaning.

Upon further thought, we realized this could be because there have been more contributions added since Stephen wrote his story in March. 

```{r}
# Put code to reverse engineer sentence here
perez_contribs <- read.csv("data/perez_contributions.csv")
```

```{r}
perez_contribs <- perez_contribs %>%
  clean_names()
```

#After cleaning our data we wanted to find a way to turn the state abbreviations from the address column into it's own column. We did not add the territories though.
```{r}
# Put code to reverse engineer sentence here
states_perez <- perez_contribs %>%
    mutate(contributor_state = case_when(
    str_detect(contributor_address, " AL ") ~ "Alabama",
    str_detect(contributor_address, " AK ") ~  "Alaska",
    str_detect(contributor_address, " AZ ") ~  "Arizona",
    str_detect(contributor_address, " AR ") ~  "Arkansas",
    str_detect(contributor_address, " CA ") ~  "California",
    str_detect(contributor_address, " CO ") ~ "Colorado",
    str_detect(contributor_address, " CT ") ~  "Connecticut",
    str_detect(contributor_address, " DE ") ~  "Delaware",
    str_detect(contributor_address, " FL ") ~  "Florida",
    str_detect(contributor_address, " GA ") ~  "Georgia",
    str_detect(contributor_address, " HI ") ~ "Hawaii",
    str_detect(contributor_address, " ID ") ~  "Idaho",
    str_detect(contributor_address, " IL ") ~  "Illinois",
    str_detect(contributor_address, " IN ") ~  "Indiana",
    str_detect(contributor_address, " IA ") ~  "Iowa",
    str_detect(contributor_address, " KS ") ~ "Kansas",
    str_detect(contributor_address, " KY ") ~  "Kentucky",
    str_detect(contributor_address, " LA ") ~  "Louisiana",
    str_detect(contributor_address, " ME ") ~  "Maine",
    str_detect(contributor_address, " MD ") ~  "Maryland",
    str_detect(contributor_address, " MA ") ~  "Massachusetts",
    str_detect(contributor_address, " MI ") ~  "Michigan",
    str_detect(contributor_address, " MN ") ~ "Minnesota",
    str_detect(contributor_address, " MS ") ~  "Mississippi",
    str_detect(contributor_address, " MO ") ~  "Missouri",
    str_detect(contributor_address, " MN ") ~  "Montana",
    str_detect(contributor_address, " NE ") ~  "Nebraska",
    str_detect(contributor_address, " NV ") ~ "Nevada",
    str_detect(contributor_address, " NH ") ~ "New Hampshire",
    str_detect(contributor_address, " NJ ") ~ "New Jersey",
    str_detect(contributor_address, " NM ") ~ "New Mexico",
    str_detect(contributor_address, " NY ") ~  "New York",
    str_detect(contributor_address, " NC ") ~ "North Carolina",
    str_detect(contributor_address, " ND ") ~ "North Dakota",
    str_detect(contributor_address, " OH ") ~ "Ohio",
    str_detect(contributor_address, " OK ") ~ "Oklahoma",
    str_detect(contributor_address, " OR ") ~ "Oregon",
    str_detect(contributor_address, " PA ") ~ "Pennsylvania",
    str_detect(contributor_address, " RI ") ~ "Rhode Island",
    str_detect(contributor_address, " SC ") ~ "South Carolina",
    str_detect(contributor_address, " SD ") ~ "South Dakota",
    str_detect(contributor_address, " TN ") ~ "Tennessee",
    str_detect(contributor_address, " TX ") ~ "Texas",
    str_detect(contributor_address, " UT ") ~ "Utah",
    str_detect(contributor_address, " VT ") ~ "Vermont",
    str_detect(contributor_address, " VA ") ~ "Virginia",
    str_detect(contributor_address, " WA ") ~ "Washington",
    str_detect(contributor_address, " WV ") ~ "West Virginia",
    str_detect(contributor_address, " WI ") ~ "Wisconsin",
    str_detect(contributor_address, " WY ") ~ "Wyoming",
    str_detect(contributor_address, " DC ") ~ "Washington DC",
    TRUE ~ contributor_address
  ))
```

#From there we ran code to find the amounts, but then realized we also needed to remove MD from the column.

```{r}
states_perez %>%
group_by(contributor_state) %>%
summarise(total_state = sum(contribution_amount),
            mean_amount= mean(contribution_amount),
          n=n()) %>%
arrange(desc(total_state))
```

#We removed MD
```{r}
states_perez_no_md <- states_perez %>%
  filter(!str_detect(contributor_state, "Maryland"))
```

#Without MD nolonger in the data we were able to rerun and get the mean amount.
```{r}
states_perez_no_md %>%
  summarise(total_state_amount = sum(contribution_amount),
          mean_amount= mean(contribution_amount),
          number_of_contribs=n())%>%
arrange(desc(total_state_amount))
```

### Sentence 3

* **Sentence text**: “Moore, a U.S. Army veteran and bestselling author, built a campaign war chest that included over $2.3 million in out-of-state contributions."
* **Analysis summary**: 

According to our code analysis, Moore received roughly $2.4 million in out-of-state contributions. According to our code, there were 5,006 contributions for a total of $2,403,216. This is slightly higher than the $2.3 million mentioned in the sentence we were reverse engineering. I'm not sure exactly how we would have added numbers, especially considering we did not work in the territories of the U.S. that contributed in this data. We will need to rerun and possibly reclean our data.

Upon further thought, we just realized this could be because there have been more contributions added since Stephen wrote his story in March.

#We followed the same steps for sentence 3 that we did in sentence 2. We created a new column for our states and then we filtered MD out before doing code to find the total amount of out-of-state contributions.

```{r}
# Put code to reverse engineer sentence here
moore_contribs_out_of_state <- read.csv("data/Moore_ContributionsList.csv")
```

```{r}
states_moore_clean <- moore_contribs_out_of_state %>%
  clean_names()
```

```{r}
# Put code to reverse engineer sentence here
states_moore <- states_moore_clean %>%
    mutate(contributor_state = case_when(
    str_detect(contributor_address, " AL ") ~ "Alabama",
    str_detect(contributor_address, " AK ") ~  "Alaska",
    str_detect(contributor_address, " AZ ") ~  "Arizona",
    str_detect(contributor_address, " AR ") ~  "Arkansas",
    str_detect(contributor_address, " CA ") ~  "California",
    str_detect(contributor_address, " CO ") ~ "Colorado",
    str_detect(contributor_address, " CT ") ~  "Connecticut",
    str_detect(contributor_address, " DE ") ~  "Delaware",
    str_detect(contributor_address, " FL ") ~  "Florida",
    str_detect(contributor_address, " GA ") ~  "Georgia",
    str_detect(contributor_address, " HI ") ~ "Hawaii",
    str_detect(contributor_address, " ID ") ~  "Idaho",
    str_detect(contributor_address, " IL ") ~  "Illinois",
    str_detect(contributor_address, " IN ") ~  "Indiana",
    str_detect(contributor_address, " IA ") ~  "Iowa",
    str_detect(contributor_address, " KS ") ~ "Kansas",
    str_detect(contributor_address, " KY ") ~  "Kentucky",
    str_detect(contributor_address, " LA ") ~  "Louisiana",
    str_detect(contributor_address, " ME ") ~  "Maine",
    str_detect(contributor_address, " MD ") ~  "Maryland",
    str_detect(contributor_address, " MA ") ~  "Massachusetts",
    str_detect(contributor_address, " MI ") ~  "Michigan",
    str_detect(contributor_address, " MN ") ~ "Minnesota",
    str_detect(contributor_address, " MS ") ~  "Mississippi",
    str_detect(contributor_address, " MO ") ~  "Missouri",
    str_detect(contributor_address, " MN ") ~  "Montana",
    str_detect(contributor_address, " NE ") ~  "Nebraska",
    str_detect(contributor_address, " NV ") ~ "Nevada",
    str_detect(contributor_address, " NH ") ~ "New Hampshire",
    str_detect(contributor_address, " NJ ") ~ "New Jersey",
    str_detect(contributor_address, " NM ") ~ "New Mexico",
    str_detect(contributor_address, " NY ") ~  "New York",
    str_detect(contributor_address, " NC ") ~ "North Carolina",
    str_detect(contributor_address, " ND ") ~ "North Dakota",
    str_detect(contributor_address, " OH ") ~ "Ohio",
    str_detect(contributor_address, " OK ") ~ "Oklahoma",
    str_detect(contributor_address, " OR ") ~ "Oregon",
    str_detect(contributor_address, " PA ") ~ "Pennsylvania",
    str_detect(contributor_address, " RI ") ~ "Rhode Island",
    str_detect(contributor_address, " SC ") ~ "South Carolina",
    str_detect(contributor_address, " SD ") ~ "South Dakota",
    str_detect(contributor_address, " TN ") ~ "Tennessee",
    str_detect(contributor_address, " TX ") ~ "Texas",
    str_detect(contributor_address, " UT ") ~ "Utah",
    str_detect(contributor_address, " VT ") ~ "Vermont",
    str_detect(contributor_address, " VA ") ~ "Virginia",
    str_detect(contributor_address, " WA ") ~ "Washington",
    str_detect(contributor_address, " WV ") ~ "West Virginia",
    str_detect(contributor_address, " WI ") ~ "Wisconsin",
    str_detect(contributor_address, " WY ") ~ "Wyoming",
    str_detect(contributor_address, " DC ") ~ "Washington DC",
    TRUE ~ contributor_address
  ))
```

```{r}
states_moore %>%
group_by(contributor_state) %>%
summarise(total_state = sum(contribution_amount),
            mean_amount= mean(contribution_amount),
          n=n()) %>%
arrange(desc(total_state))
```

```{r}
states_moore_no_md <- states_moore %>%
  filter(!str_detect(contributor_state, "Maryland"))
```

```{r}
states_moore_no_md %>%
  summarise(total_state_amount = sum(contribution_amount),
          mean_amount= mean(contribution_amount),
          number_of_contribs=n())%>%
arrange(desc(total_state_amount))
```

### Sentence 4

* **Sentence text**: [Paste in sentence to engineer here]
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Sentence 5

* **Sentence text**: [Paste in sentence to engineer here]
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

-30-